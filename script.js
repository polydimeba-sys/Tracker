const reportData = {
    "Production Breakdown": [
        { code: "1.1", name: "Production Breakdown -Sales, Waste, Agglo, Bw -Summary" }
    ],

    "Production Figures": [
        { code: "2.1", name: "Lumps & Crusher Production" },
        { code: "2.2", name: "Monthly Production Figure" },
        { code: "2.3", name: "Production Summary Analysis" },
        { code: "2.4", name: "BW Production Summary" },
        { code: "2.5", name: "B&W Analysis" },
        { code: "2.6.1", name: "Pipe Production - All Pipes" },
        { code: "2.6.2", name: "Pipe Production - Alkathene Pipes" },
        { code: "2.6.3", name: "Pipe Production - Drip Irrigation Pipes" },
        { code: "2.7", name: "Pipe Stock" },
        { code: "2.8.1", name: "Optimum Production Plan as Per Existing Machinery - All Factory Summary" },
        { code: "2.8.2", name: "Optimum Production Plan as Per Existing Machinery - Ambatale Factory" },
        { code: "2.8.3", name: "Optimum Production Plan as Per Existing Machinery - Lamination Dept." },
        { code: "2.8.4", name: "Optimum Production Plan as Per Existing Machinery - Wattala Factory" },
        { code: "2.8.5", name: "Optimum Production Plan as Per Existing Machinery - Delgoda Factory" },
        { code: "2.8.6", name: "Optimum Production Plan as Per Existing Machinery - Kandana Factory" },
        { code: "2.8.7", name: "Optimum Production Plan as Per Existing Machinery - PD India Factory" },
        { code: "2.9", name: "Screw Barrel Working " },
        { code: "2.10", name: "Ink Kitchen Production" },
        { code: "2.11", name: "Black & White Optimum Production - Daily Capacity Summary" },
        { code: "2.12", name: "Black & White Production - Optimum Capacity - All Factories" }

    ],

    "Material Useages & Composition (B&W Films)": [
        { code: "3.1", name: "Material Useages & Composition (B&W Films)" }
    ],

    "Analysis of Masterbatch & UV": [
        { code: "3.2", name: "Analysis of Masterbatch & UV" }
    ],

     "Material Usages": [
        { code: "3.3", name: "Material Usage - Ambathale & Floor Stock" },
        { code: "3.4", name: "Material Usage - Wattala & Floor Stock" },
        { code: "3.5", name: "Material Usage - Delgoda & Floor Stock" },
        { code: "3.6", name: "Material Usage - Kandana & Floor Stock" },
        { code: "3.7", name: "Material Stock - PD Sri Lanka" }
     ],

     "Solvant Usage Summary - All Factories": [
        { code: "3.8", name: "Solvant Usage Summary - All Factories" },
        { code: "3.9", name: "Solvent Usage in Black & White - Ambatale" },
        { code: "3.10", name: "Solvent Usage Wattala" },
        { code: "3.11", name: "Solvent Usage Delgoda" }
     ],    
    
     "Ink Usage Summary - All Factories": [
        { code: "3.12", name: "Ink Usage Summary - All Factories" },
        { code: "3.13", name: "Ink Usage in Black & White - Ambatale" },
        { code: "3.14", name: "Ink Usage Wattala" },
        { code: "3.15", name: "Ink Usage Delgoda" },
        { code: "3.16", name: "Ink Floor Stock - AmbathaElectricile Printing Department" },
        { code: "7.9", name: "Ink Floor Stock - Ambathale Lamination Department" },
        { code: "3.17", name: "Ink Floor Stock - Wattala" },
        { code: "3.18", name: "Ink Floor Stock  - Delgoda" },
        { code: "3.19", name: "Ink Floor Stock - Kandana" },
        { code: "3.20", name: "Ink Stock - PD Sri Lanka" }
     ],

     "Desiccant Usage": [
        { code: "3.21", name: "Desiccant Usage" }
     ],

     "Recycle Material Usage":[
        { code: "3.22", name: "Recycle Material Usage" }
     ],

     "Analysis of UV":[   
        { code: "3.23", name: "Analysis Of UV " }
     ],

     "Agglo Usage":[    
        { code: "3.24", name: "Ambatale Agglo and CACO3 Usage in Black & White Production" },
        { code: "3.24", name: "Wattala Agglo and CACO3 Usage in Black & White Production" },
        { code: "3.24", name: "BOI Agglo and CACO3 Usage in Black & White Production" },
        { code: "3.24", name: "Kandana Agglo and CACO3 Usage in Black & White Production" },
        { code: "3.24", name: "PD India Agglo and CACO3 Usage in Black & White Production" },
        { code: "3.24", name: "Factory summery Agglo and CACO3 Usage in Black & White Production" }
     ],

    "Non-woven material usage":[
        { code: "3.25", name: "Non-woven material usage" }
    ],

    "Under or Over Guage": [
        { code: "4.1", name: "Monthly Loss Profit" },
        { code: "4.2", name: "Analysis Of Loss Profit On Bags-  Summary Report" },
        { code: "4.3.1", name: "Monthly Under/Over Gauge - Ambatale Factory" },
        { code: "4.3.2", name: "Monthly Under/Over Gauge - Lamination Dept." },
        { code: "4.3.3", name: "Monthly Under/Over Gauge - Delgoda Factory" },
        { code: "4.3.4", name: "Monthly Under/Over Gauge - Wattala Factory" },
        { code: "4.3.5", name: "Monthly Under/Over Gauge - Kandana Factory" },
        { code: "4.3.6", name: "Monthly Under/Over Gauge -Pipes Factory" },
        { code: "4.4", name: "Wattala Bag Making Loss Profit" },
        { code: "4.4.1", name: "Wattala Bag Making Loss Profit" },
        { code: "4.5", name: "Wattala Local Market Guage Report" }
    ],

    "Material In Out Balancing": [
        { code: "5.1", name: "Lamination In Out Balance" },
        { code: "2.2", name: "Ambatale Extrusion In Out Balance" },
        { code: "5.3", name: "Polycycle In Out Balance" },
        { code: "5.4", name: "Keragala In Out Balance" },
        { code: "5.5", name: "Wattala In Out Balance" }
    ],

    "B&W Waste to Production": [
        { code: "6.1", name: "B&W Waste to Production - Ambatale Factory" },
        { code: "6.2", name: "B&W Waste to Production - Wattala Factory" },
        { code: "6.3", name: "B&W Waste to Production - BOI Factory" },
        { code: "6.4", name: "B&W Waste to Production - Kandana Factory" },
        { code: "6.5", name: "B&W Waste to Production - PD Sri Lanka" },
        { code: "6.5.1", name: "Waste to Production - Summary" },
        { code: "6.6", name: "Black & White Waste Usage Analysis" },
        { code: "6.7", name: "Factory Waste List" },
        { code: "6.8", name: "Ambatale Extrusion Wastage" },
        { code: "6.9", name: "Lamination Production & Waste Analysis" },
        { code: "6.10", name: "Wattala Wastage" },
        { code: "6.11", name: "Kandana  Wastage" },
        { code: "6.12", name: "BOI Wastage" },
        { code: "6.13", name: "Delgoda Wastage" },
        { code: "6.14", name: "PD India Wastage" },
        { code: "6.15", name: "Waste - Agglo Comparison" },
        { code: "6.16", name: "Waste Collection Summary Report" },
        { code: "6.17", name: "Waste Collection Summary Report - Tharanga" },
        { code: "6.18", name: "Waste In Out Management - Wattala " }

    ],

    "Lamination Department": [
        { code: "7.1", name: "Analysis of Ink,  Solvent,Glue,Tessa,COSTS IN-LAMINATION DEPT" },
        { code: "7.2", name: "DT -Lamination Dept  Order Gross Margin Average -Analysis " },
        { code: "7.3", name: "Customer Returns - Lamination" },
        { code: "7.4", name: "Salaries to production - Lamination Department" },
        { code: "7.5", name: "Performance Incentive Lamination Department " },
        { code: "7.6", name: "Lamination Solvent Usage Report" },
        { code: "7.7", name: "Lamination Glue Usage Report" },
        { code: "7.8", name: "Lamination Ink Usage Report" },
        { code: "7.9", name: "Lamination Floor Stock & Usage" },
        { code: "7.10", name: "Block_Cylinder Making Loss Profit - Checking Actual Payments" },
        { code: "7.11", name: "Lamination Simplified Costing" },
        { code: "7.12", name: "Lamination Costs Per Kg & Approtionate Costs As Per Total Overheads" },
        { code: "7.13", name: "Lamination Summary Costings & Data" }
    ],

    "Electricity": [
        { code: "8.1", name: "Ambatale - Overdime" },
        { code: "8.1.1", name: "Ambatale - Polydime" },
        { code: "8.1.2", name: "Keragala Factory" },
        { code: "8.2", name: "Kalumalli's Crusher" },
        { code: "8.3", name: "SElectricity Bills - Wattala Line 1 & 2" },
        { code: "8.3.1", name: "Electricity Bills - Delgoda" },
        { code: "8.3.2", name: "Electricity Bills - Ambathale" },
        { code: "8.3.3", name: "SElectricity Bills - Kandana" },
        { code: "8.4", name: "ELECTRICITY BILL SCHEDULE" },
        { code: "8.4.1", name: "WATER BILL SCHEDULE" },
        { code: "8.5", name: "Power Cost Per KG of Production Output - PD Sri Lanka" },
        { code: "8.6", name: "SOLAR PROJECT -NO.1 -AMBATHALE FACTORY & DELGODA FACTORY-Yield Analysis" },
        { code: "8.7", name: "Electricity Analyzer Working" }
    ],

    "Overhead": [
        { code: "9.1", name: "Overhead" },
        { code: "9.2", name: "Overhead - Cost per Kg" }
    ],

    "Lathe Calculations": [
        { code: "10.1", name: "Lathe Dept. Costs Calculation" }
    ],

    "Salaries to Production": [
        { code: "11.1", name: "Salaries, Waste to Production -Extrusion Department" },
        { code: "11.2", name: "Printing Dept" },
        { code: "11.3", name: "Bagmaking Department" },
        { code: "11.4", name: "Waste Collection & Seperation Dept" },
        { code: "11.5", name: "Recycling  Compounding Dept" },
        { code: "11.6", name: "Wattala Factory" },
        { code: "11.7", name: "Lamination Department" },
        { code: "11.8", name: "Maintaince Dept" },
        { code: "11.9", name: "Stores  Loading  Unloading" },
        { code: "11.10", name: "Transport Dept" },
        { code: "11.11", name: "Directors Staff  Catering" },
        { code: "11.12", name: "Total Salary Without Directors Staff  Catering" },
        { code: "11.13", name: "Total Salary With Directors Staff  Catering" },
        { code: "11.14", name: "Polydime India" },
        { code: "11.15", name: "All the factories cumulative figures - New Format" }
    ],

    "Performance Incentive": [
        { code: "12.1", name: "Performance Incentive Printing Production " },
        { code: "12.1.1", name: "Performance Incentive Warehouse " },
        { code: "12.1.2", name: "Performance Incentive Waste Collection Dept" },
        { code: "12.1.3", name: "Agglomerate Caco3 Usage Analysis-Wattala Factory" },
        { code: "12.1.4", name: "Lamination Agglomerate Analysis-Poly Cycle Dept" },
        { code: "12.1.5", name: "Performance Incentive - Agglomerate + Caco3 Usage Analysis -Extrusion Dept. (Ambathale Factory Only)" },
        { code: "12.1.6", name: "Block_Cylinder Making Loss Profit" },
        { code: "12.2", name: "Performance Incentive Summary" }
    ],

    "Vehicle": [
        { code: "13.1", name: "Vehicle Information (Cars, Bikes & Lorries)" },
        { code: "13.2", name: "Fuel Usage of Cars" },
        { code: "13.2.1", name: "Fuel Usage of Bikes" },
        { code: "13.2.2", name: "Fuel Usage of Trucks" },
        { code: "13.2.3", name: "Fuel Usage of Generators" },
        { code: "13.3", name: "Trucks fuel efficiency difference analysis" },
        { code: "13.4", name: "Maintenance Cost of Cars" },
        { code: "13.4.1", name: "Maintenance Cost of Bikes" },
        { code: "13.4.2", name: "Maintenance Cost of Trucks" },
        { code: "13.4.3", name: "Maintenance Cost of Generators" },
        { code: "13.4.4", name: "Maintenance Cost of Vehicle " },
        { code: "13.5", name: "Vehicle Insurance List" },
        { code: "13.6", name: "Trucks GPS Report" },
        { code: "13.7", name: "Vehicle Fuel Efficiency Analysis - Private Vehicles" },
        { code: "13.8", name: "Delivery Cost" },
        { code: "13.9", name: "Reasons for Fuel Inefficiencies" },
    ],

    "Machineries & Stationaries": [
        { code: "14.1", name: "Machinery Repairs & Maintenance" },
        { code: "14.2", name: "Computer,Fax,Photocopy Machine Maintenance & Office" },
        { code: "14.3", name: "Computer & Printers & Scanner New Updated List As AT January 2025" },
        { code: "14.4", name: "Cost Per Paper For Printing & Photocopies" }
    ],

    "Lease & Insurance": [
        { code: "15.1", name: "Performance of Leases" },
        { code: "15.2", name: "Assets & Bank Facility Position" },
        { code: "15.3", name: "Buildings, Machinerey & Stocks (Raw Material, Semi & Finished Goods) - For General Insurance -For 2022" },
        { code: "15.4", name: "Marine Insurance" }
    ],

    "Sales": [
        { code: "16.1", name: "Breakdown  Of Outgoing Sales-Total Summary" },
        { code: "16.2", name: "Sales Figures - 36 Polythene" },
        { code: "16.3", name: "Cocopeat Sales" },
        { code: "16.4", name: "Sales Summary" },
        { code: "16.5", name: "Shrink Roll Form Sales" },
        { code: "16.6", name: "Pipe Sales - All Pipes" },
        { code: "16.6.1", name: "Pipe Sales - Alkathene Pipes" },
        { code: "16.6.2", name: "Pipe Sales - Drip Irrigation Pipes" },
        { code: "16.7", name: "Gross Margin Report 36 Polythene , Pipes" },
        { code: "16.8", name: "Gross Margin Report (Others)" }
    ],

    "PD India": [
        { code: "17.1", name: "Polydime India Factory General In - Out " },
        { code: "17.2", name: "PIPPL-COST CALCULATION " },
        { code: "17.3", name: "PIPPL COSTING CLACULATION - Assets" },
        { code: "17.4", name: "Food Costing - India" },
        { code: "17.5", name: "Food Costing  Analysis - PD India" },
        { code: "17.6", name: "PD India - Overhead Costs Per KG" },
        { code: "17.7", name: "Customer Analysis" },
        { code: "17.8", name: "POLYDIME INDIA -Gross Margin " },
        { code: "17.9", name: "PD India Bank Records" },
        { code: "17.10", name: "PD India Under Over Gauge" },
        { code: "17.11", name: "PD India Order Balance" },
        { code: "17.12", name: "PD India Ink Usage" },
        { code: "17.12.1", name: "B&W Ink Usage - PD India" },
        { code: "17.13", name: "PD India Solvent Usage" },
        { code: "17.13.1", name: "B&W Solvent Usage - PD India" },
        { code: "17.14", name: "PD India Stock Report" },
        { code: "17.15", name: "PD India Material Usage Analysis" },
        { code: "17.16", name: "PD India Sri Lankan Staff Salaries & Traveling Cost" },
        { code: "17.17", name: "PD India Generator Analysis" },
        { code: "17.18", name: "PD India-Salaries & Electricity Per KG" },
        { code: "17.18.1", name: "Polydime India Salary Details" },
        { code: "17.19", name: "PD India Bank Balances" },
        { code: "17.20", name: "PD India Delivery Out" },
        { code: "17.21", name: "PD India Delivery Cost" }
    ],

    "Cocopeat ": [
        { code: "18.1", name: "Cocopeat Statistics " },
        { code: "18.1.1", name: "COCOPEAT Export Data Analysis - Sri Lanka Market" },
        { code: "18.1.2", name: "COCOPEAT Export Data Analysis - Indian Market" },
        { code: "18.2", name: "Member List - Exporter Association of Coconut Based Substrates Latest" }
    ],

    "Investment": [
        { code: "19.1", name: "Investment Summary " },
        { code: "19.1.1", name: "Share Market  Analysis" },
        { code: "19.2", name: "Share Market -  Price Analysis" }
    ],

    "Market Analysis": [
        { code: "20.1", name: "Important Calculations of Hypothetical Scenarios" },
        { code: "20.2", name: "Currency in Circulation in Sri Lanka" },
        { code: "20.3", name: "Sri Lanka Export Analysis" },
        { code: "20.4", name: "Sri Lanka Import Analysis" },
        { code: "20.5", name: "Debt per capita in Sri Lanka" },
        { code: "20.6", name: "COSTING OF IMPORTS  (Raw , lamination material & machinery parts ) - Rumeka using" },
        { code: "20.7", name: "Competitor Analysis" },
        { code: "20.8", name: "Competitor Analysis - New Format" }
    ],

    "Internal Audit Report": [
        { code: "21.1", name: "Ink Inventory - Ambathale - 2023" },
        { code: "21.2", name: "Stationary Expenses - 02-04-2024" },
        { code: "21.3", name: "Computer & Fax   - 07-08-2024" },
        { code: "21.4", name: "Overseas Travel Expenses 20-09-2024" },
        { code: "21.5", name: "Ink Inventory - Wattala - 22-10-2024" },
        { code: "21.6", name: "Communication Expenses -24-10-2024" },
        { code: "21.7", name: "Ink Inventory - Kandana - 28 -10-2024" },
        { code: "21.8", name: "Ink Inventory - Ambathale - Printing - 29-11-2024" },
        { code: "21.9", name: "Ink Inventory - Ambathale - Warehouse -31-10-2024" },
        { code: "21.10", name: "Solvent Inventory - Ambathale  -31-10-2024" },
        { code: "21.11", name: "Ink Inventory - Lamination -30-11-2024" },
        { code: "21.12", name: "Loan & Leases - 27-02-2025" },
        { code: "21.13", name: "Repair & maintenance - 10-03-2025" },
        { code: "21.15", name: "Communication Expenses -28-05-2025" },
        { code: "21.16", name: "Computer,Fax,Photocopy Machine Maintenance & Office - 05-06-2025" },
        { code: "21.17", name: "Interest & Charges - 16-06-2025" },
        { code: "21.18", name: "Glue & Solvent Stock -Ambathale - 26.06.2025" },
        { code: "21.19", name: "Waste Stock -Wattala - 20.06.2025" },
        { code: "21.20", name: "Loan & Leases - 02-10-2025" }
    ],

    "Costing": [
        { code: "22.1", name: "Black & White Costing" },
        { code: "22.2", name: "Master Batch Loss Profit" },
        { code: "22.3", name: "Mesh Analysis" },
        { code: "22.4", name: "Stretch Film Analysis" },
        { code: "22.5", name: "Overhead Costing" },
        { code: "22.6", name: "Costings - Main Products" },
        { code: "22.7", name: "Raw Material Trading Costing" }
    ],

    "Other": [
        { code: "23.1", name: "Exchange Rate Working" },
        { code: "23.2", name: "Ink Price Analysis between India and Sri Lanka" },
        { code: "23.3", name: "Production - Special Requirement" },
        { code: "23.4", name: "Daily CCTV Check List" },
        { code: "23.5", name: "Analysis of Mistaken Orders" },
        { code: "23.6", name: "Electronic Vehicles" },
        { code: "23.7", name: "Meal Cost - All factories" },
        { code: "23.8", name: "Construction" },
        { code: "23.9", name: "Summary - 2024" },
        { code: "23.10", name: "Working Capital Position" },
        { code: "23.11", name: "AC Repair - Workmen Efficiency" },
        { code: "23.12", name: "Compressor & Generators Repair" },
        { code: "23.13", name: "Data Gatheing Sheet" }
    ],

    "Fixed Assets": [
        { code: "24.1", name: "Assets Verification" }
    ],

    "Internal Controls": [
        { code: "25.1", name: "Preparation of internal audit procedures, preform & Update periodically " },
        { code: "25.1.1", name: "Cash outflow related procedures , preform & Update periodically " },
        { code: "25.1.2", name: "Security related procedures , preform & Update periodically " },
        { code: "25.1.3", name: "Purchasing related procedures , preform & Update periodically " },
        { code: "25.1.4", name: "Check all cash related documents and accuracy of approval process (Factory Main, Petty Cash & IOU)" },
        { code: "25.1.5", name: "Purchasing price analysis (Machine Parts, Printing & Stationery, Computer & Accessories etc.)" },
        { code: "25.1.6", name: "Surprise cash counts and check records (Main cash & Petty cash)" },
        { code: "25.2", name: "PD India Reporting (Check all documents and accuracy of approval process)" },
        { code: "25.2.1", name: "Federal Bank - New Delhi - Current Account - 13600 20012 8157 ( Main Cash all doc.s with approvels)" },
        { code: "25.2.2", name: "Federal Bank - Pollachi - Current Account - 11790200018946 (Petty Cash all doc.s with approvels)" },
        { code: "25.2.3", name: "Federal Bank - New Delhi - Savings Account - 13600600079364" },
        { code: "25.2.4", name: "Federal Bank - New Delhi - Fixed Deposits - 06 No's" },
        { code: "25.2.5", name: "IDBI Bank - Pollachi  - Current Account - 03941020 00011714" },
        { code: "25.2.6", name: "IDBI Bank - Pollachi  - Current Account - 0394102000011723" },
        { code: "25.2.7", name: "PD India-Salaries & Electricity Per KG & Fuel Usage Analysis & Reporting" },
        { code: "25.2.8", name: "Monitor Meal Cost PD India" },
        { code: "25.2.9", name: "PD India Overhead spendings Analysis & Reporting" },
        { code: "25.3", name: "Loan Reconciliations " },
        { code: "25.3.1", name: "Monitor loan & Lease deductions and check accuracy (Company & Personal)" },
        { code: "25.4", name: "Financial ratio analysis all companies (OD/PD/PD India)" },
        { code: "25.5", name: "Investments" },
        { code: "25.5.1", name: "Overlook Company and Mr. Dishanâ€™s investments including share market & Money Market" },
        { code: "25.6", name: "Assets" },
        { code: "25.6.1", name: "Monitor all retainable items & Assets return to the factory timely manner" },
        { code: "25.7", name: "Personal Tax Planning" },
        { code: "25.7.1", name: "Personal Tax planning with discuss with Mr. Saman " },
        { code: "25.8", name: "Other Monitoring works" },
        { code: "25.8.1", name: "Waste Sale monitoring " },
        { code: "25.8.2", name: "H/O Petty cash summery check with Chandrika" },
        { code: "25.8.3", name: "LOGO Registation Tracking" }
    ]
};


let finalRows = [];

function login() {
    const user = document.getElementById("username").value;
    if (!user) return alert("Select user");

    document.getElementById("userDisplay").innerText = user;
    document.getElementById("loginCard").classList.add("hidden");
    document.getElementById("trackerCard").classList.remove("hidden");

    loadFolders();
}

function loadFolders() {
    const folderGroup = document.getElementById("folderGroup");
    folderGroup.innerHTML = "";

    Object.keys(reportData).forEach(folder => {
        const label = document.createElement("label");
        label.innerHTML = `
            <input type="checkbox" value="${folder}" onchange="loadReports()"> ${folder}
        `;
        folderGroup.appendChild(label);
    });
}

function loadReports() {
    const reportGroup = document.getElementById("reportGroup");
    reportGroup.innerHTML = "";

    const selectedFolders = getCheckedValues("#folderGroup input");

    selectedFolders.forEach(folder => {
        reportData[folder].forEach(report => {
            const code = report.code || "";
            const name = report.name || report; // fallback if it's a string

            const label = document.createElement("label");
            label.innerHTML = `
                <input type="checkbox" 
                       value="${name}" 
                       data-folder="${folder}">
                ${code}: ${name}
            `;
            reportGroup.appendChild(label);
        });
    });
}




function getCheckedValues(selector) {
    return Array.from(document.querySelectorAll(selector))
        .filter(cb => cb.checked)
        .map(cb => cb.value);
}

function addReports() {
    const folders = getCheckedValues("#folderGroup input");
    const reports = getCheckedValues("#reportGroup input");
    const types = getCheckedValues('input[value="Final"], input[value="Standard"]');
    const month = document.getElementById("monthSelect").value;
    const date = document.getElementById("reportDate").value;
    const freqs = getCheckedValues(
        'input[value="Weekly"], input[value="Monthly"], input[value="Quarterly"], input[value="Yearly"], input[value="Annually"]'
    );

    if (!folders.length || !reports.length || !types.length || !freqs.length || !month || !date) {
        alert("Please select all required fields (including Month and Date)");
        return;
    }

    const area = document.getElementById("reportProgressArea");

    reports.forEach(report => {
        types.forEach(type => {
            freqs.forEach(freq => {
                const div = document.createElement("div");
                div.className = "report-card";
                div.innerHTML = `
                    <strong>${report}</strong><br>
                    Folder: ${folders.join(", ")}<br>
                    Type: ${type} | Frequency: ${freq}
                    Month: ${month}<br>
                    Date: ${date}
                    
                    <select onchange="updateProgress(this)">
                        <option value="draft">Draft</option>
                        <option value="finished">Finished</option>
                    </select>

                    <div class="progress-container">
                        <div class="progress-bar"></div>
                    </div>
                `;
                area.appendChild(div);

                finalRows.push({
                    Folder: folders.join(", "),
                    Report: report,
                    Type: type,
                    Frequency: freq,
                    Month: month,
                    Date: date,
                    Status: "Draft"
                });
            });
        });
    });
}

function updateProgress(select) {
    const bar = select.parentElement.querySelector(".progress-bar");
    if (select.value === "finished") {
        bar.classList.add("finished");
    } else {
        bar.classList.remove("finished");
    }
}

function saveToExcel() {
    if (!finalRows.length) {
        alert("No data to export");
        return;
    }

    const ws = XLSX.utils.json_to_sheet(finalRows);
    const wb = XLSX.utils.book_new();
    XLSX.utils.book_append_sheet(wb, ws, "Tracker 2026");
    XLSX.writeFile(wb, "Tracker 2026.xlsx");
}
